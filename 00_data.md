

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L18"
target="_blank" style="float:right; font-size:smaller">source</a>

### DataLoader

>  DataLoader (max_records:int=None)

\*A class for loading and processing time series data with adjustable
parameters.

This class handles loading CSV data, computing returns, and calculating
rolling variance.

Attributes: max_records: Maximum number of records to keep (from the end
of the dataset)\*

``` python
# Create a data loader with default parameters and load the data
data_loader = DataLoader(max_records=9000)
source_df = data_loader.load_data("./data/ng_daily.csv")
source_df.head()
```

<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 3)</small>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">ret</th>
</tr>
<tr>
<th>date</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr>
<td>1997-01-07</td>
<td>3.82</td>
<td>null</td>
</tr>
<tr>
<td>1997-01-08</td>
<td>3.8</td>
<td>0.994764</td>
</tr>
<tr>
<td>1997-01-09</td>
<td>3.61</td>
<td>0.95</td>
</tr>
<tr>
<td>1997-01-10</td>
<td>3.92</td>
<td>1.085873</td>
</tr>
<tr>
<td>1997-01-13</td>
<td>4.0</td>
<td>1.020408</td>
</tr>
</tbody>
</table>

</div>

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L153"
target="_blank" style="float:right; font-size:smaller">source</a>

### FeatureEngineer

>  FeatureEngineer (transforms:list[__main__.DFFeature], n_shifts=3,
>                       drop_nulls:bool=True)

\*A class for creating lagged features from time series data.

This class handles the creation of lagged (shifted) features that can be
used for GARCH-like models and other time series forecasting tasks.

Attributes: columns: List of column names to create lags for n_shifts:
Number of lag periods to create drop_nulls: whether to drop the nulls
after rolling window calculations\*

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L145"
target="_blank" style="float:right; font-size:smaller">source</a>

### Derivative

>  Derivative (source_field:str, feature_name:str,
>                  requested_lag:int|None=None, step_size:int=1)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L139"
target="_blank" style="float:right; font-size:smaller">source</a>

### Identity

>  Identity (source_field:str, feature_name:str,
>                requested_lag:int|None=None, step_size:int=1)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L133"
target="_blank" style="float:right; font-size:smaller">source</a>

### LogReturn

>  LogReturn (source_field:str, feature_name:str,
>                 requested_lag:int|None=None, step_size:int=1)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L125"
target="_blank" style="float:right; font-size:smaller">source</a>

### Square

>  Square (source_field:str, feature_name:str, requested_lag:int|None=None,
>              step_size:int=1)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L112"
target="_blank" style="float:right; font-size:smaller">source</a>

### Variance

>  Variance (source_field:str, feature_name:str,
>                requested_lag:int|None=None, step_size:int=1,
>                rolling_variance_window:int=3)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L78"
target="_blank" style="float:right; font-size:smaller">source</a>

### QuantileTransformer

>  QuantileTransformer (source_field:str, feature_name:str,
>                           requested_lag:int|None=None, step_size:int=1,
>                           n_quantiles:int=1000,
>                           output_distribution:str='uniform')

*A stateful quantile transformer using sklearnâ€™s QuantileTransformer.*

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L70"
target="_blank" style="float:right; font-size:smaller">source</a>

### ZeroBasedMonth

>  ZeroBasedMonth (source_field:str, feature_name:str,
>                      requested_lag:int|None=None, step_size:int=1)

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L55"
target="_blank" style="float:right; font-size:smaller">source</a>

### DFFeature

>  DFFeature (source_field:str, feature_name:str,
>                 requested_lag:int|None=None, step_size:int=1)

``` python
feature_engineer = FeatureEngineer(
    transforms=[
        LogReturn(source_field="ret", feature_name="log_ret"),
        Variance(source_field="price", feature_name="var", requested_lag=0),
        QuantileTransformer(
            source_field="var", feature_name="var_quantile", requested_lag=0
        ),
    ],
    n_shifts=3,
)
df_with_features = feature_engineer.create_features(source_df)
df_with_features.head()
```

<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 9)</small>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">ret</th>
<th data-quarto-table-cell-role="th">log_ret</th>
<th data-quarto-table-cell-role="th">var</th>
<th data-quarto-table-cell-role="th">var_quantile</th>
<th data-quarto-table-cell-role="th">prev_log_ret_1</th>
<th data-quarto-table-cell-role="th">prev_log_ret_2</th>
<th data-quarto-table-cell-role="th">prev_log_ret_3</th>
</tr>
<tr>
<th>date</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr>
<td>1997-01-13</td>
<td>4.0</td>
<td>1.020408</td>
<td>0.020203</td>
<td>0.042433</td>
<td>0.860861</td>
<td>0.082384</td>
<td>-0.051293</td>
<td>-0.005249</td>
</tr>
<tr>
<td>1997-01-14</td>
<td>4.01</td>
<td>1.0025</td>
<td>0.002497</td>
<td>0.002433</td>
<td>0.316111</td>
<td>0.020203</td>
<td>0.082384</td>
<td>-0.051293</td>
</tr>
<tr>
<td>1997-01-15</td>
<td>4.34</td>
<td>1.082294</td>
<td>0.079083</td>
<td>0.037433</td>
<td>0.847429</td>
<td>0.002497</td>
<td>0.020203</td>
<td>0.082384</td>
</tr>
<tr>
<td>1997-01-16</td>
<td>4.71</td>
<td>1.085253</td>
<td>0.081814</td>
<td>0.122633</td>
<td>0.944662</td>
<td>0.079083</td>
<td>0.002497</td>
<td>0.020203</td>
</tr>
<tr>
<td>1997-01-17</td>
<td>3.91</td>
<td>0.830149</td>
<td>-0.186151</td>
<td>0.1603</td>
<td>0.95773</td>
<td>0.081814</td>
<td>0.079083</td>
<td>0.002497</td>
</tr>
</tbody>
</table>

</div>

``` python
qt = QuantileTransformer(source_field="price", feature_name="price_quantile")
qt.fit(source_df)
source_df = qt.extract(source_df)
source_df.head()
```

<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 4)</small>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">ret</th>
<th data-quarto-table-cell-role="th">price_quantile</th>
</tr>
<tr>
<th>date</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr>
<td>1997-01-07</td>
<td>3.82</td>
<td>null</td>
<td>0.573073</td>
</tr>
<tr>
<td>1997-01-08</td>
<td>3.8</td>
<td>0.994764</td>
<td>0.569069</td>
</tr>
<tr>
<td>1997-01-09</td>
<td>3.61</td>
<td>0.95</td>
<td>0.535536</td>
</tr>
<tr>
<td>1997-01-10</td>
<td>3.92</td>
<td>1.085873</td>
<td>0.591091</td>
</tr>
<tr>
<td>1997-01-13</td>
<td>4.0</td>
<td>1.020408</td>
<td>0.607107</td>
</tr>
</tbody>
</table>

</div>

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L279"
target="_blank" style="float:right; font-size:smaller">source</a>

### append_from_log_ret

>  append_from_log_ret (df:polars.dataframe.frame.DataFrame,
>                           new_log_ret:float, inherit_vals:list[str],
>                           add_variables:dict[str,float])

\*Adds a new record to the dataframe based on a log return value.

Args: df: Input DataFrame containing time series data new_log_ret: The
new log return value to add

Returns: DataFrame with a new row appended\*

------------------------------------------------------------------------

<a
href="https://github.com/sofeikov/bayesianfin/blob/main/bayesianfin/data.py#L321"
target="_blank" style="float:right; font-size:smaller">source</a>

### binary_feature_from_date_ranges

>  binary_feature_from_date_ranges
>                                       (date_range:tuple[datetime.date,datetime
>                                       .date], periods:list[tuple[datetime.date
>                                       ,datetime.date]],
>                                       feature_name:str='feature')

``` python
binary_feature_from_date_ranges(
    date_range=(date(2010, 1, 1), date(2026, 1, 1)),
    periods=[
        (date(2022, 2, 24), date(2026, 1, 1)),
    ],
    feature_name="RU/UA_war",
)
```

<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5_845, 2)</small>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">RU/UA_war</th>
</tr>
<tr>
<th>date</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010-01-01</td>
<td>0</td>
</tr>
<tr>
<td>2010-01-02</td>
<td>0</td>
</tr>
<tr>
<td>2010-01-03</td>
<td>0</td>
</tr>
<tr>
<td>2010-01-04</td>
<td>0</td>
</tr>
<tr>
<td>2010-01-05</td>
<td>0</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr>
<td>2025-12-28</td>
<td>1</td>
</tr>
<tr>
<td>2025-12-29</td>
<td>1</td>
</tr>
<tr>
<td>2025-12-30</td>
<td>1</td>
</tr>
<tr>
<td>2025-12-31</td>
<td>1</td>
</tr>
<tr>
<td>2026-01-01</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
